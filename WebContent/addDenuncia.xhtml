<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">

<ui:composition template="/WEB-INF/templates/padraoDenuncia.xhtml">
	<ui:define name="title">
	    Fui Roubado
	</ui:define>
	<ui:define name="content">
		<div class="container-fluid fundo " style="height: 100%">
			<div class="col-md-5 col-xs-12" style="height: 100%; padding: 15px;">
				<script type="text/javascript"
					src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBf8gq4BKk_Qn_qmUoXe1RmCSrau5_Mm7Y">
	    			</script>
				<script>
						var geocoder;
						var map;
						var infowindow = new google.maps.InfoWindow();
						var marker;
						
						  geocoder = new google.maps.Geocoder();
						  
						function initialize() {
						  var mapOptions = {
						    zoom: 15,
							disableDefaultUI: true,
						  };
						  map = new google.maps.Map(document.getElementById('map-canvas'),
						      mapOptions);
							  
						  // Try HTML5 geolocation
						  if(navigator.geolocation) {
						    navigator.geolocation.getCurrentPosition(function(position) {
						      var pos = new google.maps.LatLng(position.coords.latitude,
						                                       position.coords.longitude);
						
								document.getElementById("form:latitude").value = position.coords.latitude;
								document.getElementById("form:longitude").value = position.coords.longitude; 
								codeLatLng();
						      marker = new google.maps.Marker({
						        map: map,
						        position: pos,
								draggable: true,
						      });
						
								google.maps.event.addListener(marker, 'dragend', function(evt){
								document.getElementById("form:latitude").value = evt.latLng.lat();
								document.getElementById("form:longitude").value =evt.latLng.lng() ; 
								codeLatLng();
							});
								
						      map.setCenter(pos);
						    }, function() {
						      handleNoGeolocation(true);
						    });
						  } else {
						    // Browser doesn't support Geolocation
						    handleNoGeolocation(false);
						  }
						}
						
						function handleNoGeolocation(errorFlag) {
						  if (errorFlag) {
						    var content = 'Você foi redimencionado ao Rio de Janeiro!';
						  } else {
						    var content = 'Error: Your browser doesn\'t support geolocation.';
						  }
						 posicao = new google.maps.LatLng(-22.9035, -43.2096);
						  var options = {
						    map: map,
						    position: new google.maps.LatLng(-22.9035, -43.2096),
						  };
							marker = new google.maps.Marker({
						        map: map,
						        position: posicao,
								draggable: true,
						      });
						  map.setCenter(options.position);
						}
						
						
						function codeLatLng() {
						  var lat = document.getElementById('form:latitude').value;
						  var lng = document.getElementById('form:longitude').value;
						  var latlng = new google.maps.LatLng(lat, lng);
						  geocoder.geocode({'latLng': latlng}, function(results, status) {
						    if (status == google.maps.GeocoderStatus.OK) {
						      if (results[1]) {
								document.getElementById("form:endereco").value = results[0].formatted_address;
						      } else {
						        alert('No results found');
						      }
						    } else {
						      alert('Geocoder failed due to: ' + status);
						    }
						  });
						}
						google.maps.event.addDomListener(window, 'load', initialize);
				    </script>
				<div id="map-canvas"></div>
			</div>
			<div class="col-md-7 col-xs-12 fundoDenuncias " style="margin-top: 1%">
				<h:form id="form" enctype="multipart/form-data">
					<h:outputLabel style="text-align: left; color: #fff;"
						class="seguranca" value="Dados do Crime:" />
					<div class="col-md-12 " style="text-align: left">
						<h:outputLabel value="Endereço:" />
						<h:inputText id="endereco" readonly="true"
							style="-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none; user-select: none;cursor: default;"
							class="form-control"
							value=" #{denunciaMB.denuncia.local.endereco}" />
						<h:inputHidden id="latitude"
							value="#{denunciaMB.denuncia.local.latitude}" />
						<h:inputHidden id="longitude"
							value="#{denunciaMB.denuncia.local.longitude}" />
						<h:inputHidden id="cidade"
							value="#{denunciaMB.denuncia.local.cidade.cidade}" />
					</div>

					<div class="col-md-8">
						<h:outputLabel value="Tipo de Ocorrencia:" />
						<h:selectOneMenu styleClass="form-control"
							value="#{denunciaMB.denuncia.tipo}">
							<f:selectItem itemLabel="Selecione" />
							<f:selectItems value="#{denunciaMB.tipos}" var="tipo"
								itemLabel="#{tipo.descricao}" itemValue="#{tipo}" />
						</h:selectOneMenu>

					</div>
					<div class="col-md-4">
						<h:outputLabel>Realizou B.O?</h:outputLabel>
						<h:selectOneMenu styleClass="form-control" value="#{denunciaMB.denuncia.bo}">
							<f:selectItem itemValue="0" itemLabel="Selecione" />
							<f:selectItem itemValue="1" itemLabel="Sim" />
							<f:selectItem itemValue="2" itemLabel="Não" />
						</h:selectOneMenu>
					</div>
					<div class="col-md-4">
						<h:outputLabel>Data:</h:outputLabel>
						<h:inputText styleClass="form-control" value="#{denunciaMB.denuncia.date}">
							<f:convertDateTime pattern="MM/dd/yyyy"/>
						</h:inputText>
					</div>
					<div class="col-md-4">
						<h:outputLabel>Horario aproximado:</h:outputLabel>
						<h:inputText  id="horario" value="#{denunciaMB.denuncia.horario}"/>
						<div class="col-md-6">
							<select id="comboHorarioHora" class="form-control ">
								<option style="padding:0px;" value="Selecione" label="Selecione" />
								<option value="00" label="00" />
								<option value="01" label="01" />
								<option value="02" label="02" />
								<option value="03" label="03" />
								<option value="04" label="04" />
								<option value="05" label="05" />
								<option value="06" label="06" />
								<option value="07" label="07" />
								<option value="08" label="08" />
								<option value="09" label="09" />
								<option value="10" label="10" />
								<option value="11" label="11" />
								<option value="12" label="12" />
								<option value="13" label="13" />
								<option value="14" label="14" />
								<option value="15" label="15" />
								<option value="16" label="16" />
								<option value="17" label="17" />
								<option value="18" label="18" />
								<option value="19" label="19" />
								<option value="20" label="20" />
								<option value="21" label="21" />
								<option value="22" label="22" />
								<option value="23" label="23" />
							</select>
						</div>
						<div class="col-md-6">
							<select id="comboHorarioMin" class="form-control ">
								<option style="padding:0px;" value="Selecione" label="Selecione" />
								<option value="00" label="00" />
								<option value="15" label="15" />
								<option value="30" label="30" />
								<option value="45" label="45" />
							</select>
						</div>
						<script>
						$("#comboHorarioMin").on("change",function () {
							document.getElementById("horario").value= $("#comboHorarioHora").val()+":"+$("#comboHorarioMin").val();
						});
						$("#comboHorarioHora").on("change",function () {
							document.getElementById("horario").value = $("#comboHorarioHora").val()+":"+$("#comboHorarioMin").val();
						});
						</script>
					</div>
					<br></br>
					<div class="col-md-12">
						<h:outputLabel value="Objeto Roubado:" />
						<h:selectManyCheckbox value="#{denunciaMB.denuncia.objetos}"
							styleClass="testando">
							<f:selectItems value="#{objetoMB.objetos}" var="tipo"
								itemLabel="#{tipo.descricao}" itemValue="#{tipo}" />
						</h:selectManyCheckbox>
					</div>
						<div class="col-md-12">
							<h:inputTextarea styleClass="form-control descricao" value="#{denunciaMB.denuncia.descricao}" />	
							<span class="quantidade">256 Caracteres restantes</span>
						</div>
						
						<script>
							$(".descricao").on('keyup',function(event){
						         $(this).val($(this).val().substring(0,256));
								if(this.value.length != 256){
									$(".quantidade").text(256-this.value.length+" caracteres restantes");
								} else {
									$(".quantidade").text("Você utilizou todos os caracteres.");
								}
							});
							$(".descricao").on('keydown',function(event){
						         $(this).val($(this).val().substring(0,255));
							});
						</script>
					<div class="row">
						<div class="col-md-12">
							<h:commandButton styleClass="btn btn-defaut"
								style="margin-top:3%;" action="#{denunciaMB.salvar()}"
								value="Salvar" />
						</div>
					</div>
				</h:form>
			</div>
		</div>

	</ui:define>

</ui:composition>
</html>

